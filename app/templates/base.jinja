<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>{% block title %}Página Web{% endblock %}</title>

    <!-- Estilos -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/normalize.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap-material-design.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/all.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/sweetalert2.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/jquery.mCustomScrollbar.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/breadcrumb.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/carrusel.css') }}">
    
</head>
<body>
    <main class="full-box main-container">
        {% if show_sidebar is not defined or show_sidebar %}
        <section class="full-box nav-lateral">
            <div class="full-box nav-lateral-bg show-nav-lateral"></div>
            <div class="full-box nav-lateral-content">
                <figure class="full-box nav-lateral-avatar text-light">
                    <i class="far fa-times-circle show-nav-lateral"></i>
                    <img src="{{ url_for('static', filename='assets/avatar/5.jpg') }}" class="img-fluid" alt="Avatar">
                    <figcaption class="roboto-medium text-center">
                        {{ session.get('usuario_nombre', 'Usuario') }} <br>
                        <small class="roboto-condensed-light">{{ session.get('rol', 'Rol no definido') }}</small>
                    </figcaption>
                </figure>
                <div class="full-box nav-lateral-bar"></div>
                <nav class="full-box nav-lateral-menu">
                    <ul>
                        <li>
                            <a href="{{ url_for('main.inicio') }}"><i class="fas fa-home fa-fw"></i> &nbsp; Home</a>
                        </li>
                        {% if session.get('modulos') %}
                            {% for modulo in session['modulos'] %}
                                <li>
                                    <a href="#" class="nav-btn-submenu">
                                        <i class="fas fa-folder fa-fw"></i> &nbsp; {{ modulo['nombre_modulo'] | capitalize }}
                                        <i class="fas fa-chevron-down"></i>
                                    </a>
                                    <ul>
                                        {% for seccion in modulo['secciones'] %}
                                            <li>
                                                <a href="{{ seccion['url'] }}"><i class="fas fa-angle-right fa-fw"></i> &nbsp; {{ seccion['nombre'] }}</a>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                </li>
                            {% endfor %}
                        {% else %}
                            <li><a href="#"><i class="fas fa-exclamation-circle"></i> &nbsp; Sin módulos asignados</a></li>
                        {% endif %}
                    </ul>
                </nav>
            </div>
        </section>
        {% endif %}

        <section class="full-box page-content">
            <nav class="full-box navbar-info">

                <nav class="navbar navbar-expand-lg navbar-light bg-light">
                    <div class="container-fluid">
                        <form method="GET" action="{{ url_for('main.buscar_avanzada') }}" class="search-bar-advanced">
                            <!-- Filtro desplegable -->
                            <select name="categoria" class="form-select">
                                <option value="">Todas las categorías</option>
                                <option value="materias" {% if request.args.get('categoria') == 'materias' %} selected {% endif %}>Materias</option>
                                <option value="juegos" {% if request.args.get('categoria') == 'juegos' %} selected {% endif %}>Juegos</option>
                                <option value="proyectos" {% if request.args.get('categoria') == 'proyectos' %} selected {% endif %}>Proyectos</option>
                            </select>
                            <!-- Campo de búsqueda avanzada -->
                            <input 
                                type="text" 
                                class="form-control" 
                                name="advanced_query"  
                                placeholder="Buscar en toda la plataforma..." 
                                value="{{ request.args.get('advanced_query', '') }}"
                            >
                            <!-- Botón de búsqueda -->
                            <button class="btn" type="submit">
                                <i class="fas fa-search"></i>
                            </button>
                        </form>
                        
                    </div>
                </nav>
                
                
                

                <a href="#" class="float-left show-nav-lateral"><i class="fas fa-exchange-alt"></i></a>
                <!-- Iconos en la parte superior derecha -->
    <div class="top-icons">
        <a href="#" data-toggle="modal" data-target="#ModalHelp"><i class="far fa-question-circle"></i></a>
        <a href="#"><i class="fas fa-user-cog"></i></a>
        <a href="#" class="btn-exit-system" data-logout-url="{{ url_for('auth.logout') }}">
            <i class="fas fa-power-off"></i>
        </a>
        
    </div>
            </nav>

            <div>
                {% block breadcrumb %}
                {% endblock %}
            </div>
            

            {% block content %}
            {% endblock %}
        </section>
    </main>

    <script src="{{ url_for('static', filename='js/jquery-3.4.1.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/popper.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/jquery.mCustomScrollbar.concat.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/bootstrap-material-design.min.js') }}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        $(document).ready(function() {
            $('body').bootstrapMaterialDesign();
        });
    </script>
    

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    
    {% if request.endpoint == "main.mostrar_modulo" %}
        <script src="{{ url_for('static', filename='js/scroll.js') }}"></script>
    {% endif %}
    
    {% if request.endpoint == "main.mostrar_seccion" %}
        <script src="{{ url_for('static', filename='js/seccion.js') }}"></script>
    {% endif %}
    
    {% if request.endpoint == "main.buscar" %}
        <script src="{{ url_for('static', filename='js/buscar.js') }}"></script>
    {% endif %}
    
    {% if request.endpoint == "main.buscar_avanzada" %}
        <script src="{{ url_for('static', filename='js/buscar_avanzado.js') }}"></script>
    {% endif %}
    
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const closeButtons = document.querySelectorAll('.close-btn, .close');
        closeButtons.forEach(button => {
            button.addEventListener('click', function () {
                this.closest('.alert').style.display = 'none';
            });
        });
    });
</script>

    
</body>
</html>
